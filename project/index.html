<html>
  <head>
    <!-- Bootstrap CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />

    <!-- jQuery CDN -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> -->
    <script type="text/javascript" src="jquery.js"></script>
  </head>
  <body>
    <button
      id="btn_load_next"
      type="button"
      class="btn btn-outline-primary d-flex justify-content-center"
    >
      Next ad
    </button>

    <h1 id="result">result</h1>
  </body>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript">
    const ads = [
      {
        id: 1,
        title: "IPHONE X",
        subtitle: "treat yourself with the best",
        message: [
          "IPHONE X is the best!",
          "SPEED, CAMERA AND CONVINIENCE",
          ":)",
        ],
        img: [
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT8lm14j1aFtlT3Gjv9SSpybhtvN695XsSNIA&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRfnHHKAETeAJU_9_6wEIF-3eVr40CYh2j1mA&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTBkIFXmUMxK44ZOT2t7NE0YOE3z_TO9gztXQ&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQm3gsU-6BJau1nx_q18ygEXijsNN3D8EX6Ng&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT01PPbf3eScTaKUs8QLtie5WbVOcLH38edxA&usqp=CAU",
        ],
        template: "a",
        ttl: 3000,
        dates: {
          range: [new Date("2022-04-04"), new Date("2022-05-23")],
          days: [0, 1, 3, 4, 6],
          hours: [6, 16],
        },
      },
      {
        id: 2,
        title: "PIZZA",
        subtitle: "best you'll ever eat",
        message: [
          "OUR BEST ITALIAN PIZZA",
          "DELIEVERY ALL AROUND THE CLOCK",
          "JUST CALL *2338",
        ],
        img: [
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTvEkpcYeFIB73iycwLEMGx8_BBd5fVqDuZXA&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ3zPwiD1uXen7dE7XVFs1j7wsJozC85nCW1Q&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTwuK8CzlD2aK-HVxmwFLaSNyF3YmOL3jN3Cw&usqp=CAU",
        ],
        template: "b",
        ttl: 5000,
        dates: {
          range: [new Date("2022-04-01"), new Date("2022-04-30")],
          days: [0, 1, 2, 3, 4],
          hours: [1, 23],
        },
      },
      {
        id: 3,
        title: "FASHION CLOTHES",
        subtitle: "best quality and style",
        message: [
          "MOST TREDY FASHIONABLE CLOTHES",
          "END OF SEASON SALE",
          "FIND US ON FACEBOOK INSTAGRAM AND TWITTER",
        ],
        img: [
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTJ5JKDq-H9qcPjlsgoD0jwk0icF_2o5VK13g&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT3h7Srl3VH6UKcZilNaqd8CDszPz3BFm7cKA&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTfoTNUAr8EblvyTYt5KUfuCJIJwHS6MWtQHw&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS5iDH51DsoiKniHE78gKQSNX06YQOK_dNrvQ&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSV-aM7fdhAmOSMUSf2eoZp24ua0cKxsUuahg&usqp=CAU",
        ],
        template: "a",
        ttl: 3000,
        dates: {
          range: [new Date("2022-03-16"), new Date("2022-05-01")],
          days: [0, 1, 2, 5, 6],
          hours: [2, 20],
        },
      },
      {
        id: 3,
        title: "TRAVEL GUIDES",
        subtitle: "professional with years of experience",
        message: [
          "TRAVEL WITH US",
          "BEST OFFERS AND DEALS",
          "GARENTEE LOWEST PRICES",
          "CALL US *3511",
          "BEST ADVICE AND TRAVEL GUIDES",
          "TRAVEL MORE SPEND LESS",
        ],
        img: [
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSRKfSfz1S9uLK-i_6zwl0nZWPi2iOcuIrySQ&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTucmKObBIfH2nKabaYcjot0CgopVZaXhzyig&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQMSqgtKElpRJtMg9G6MjoDIGjMq0xxBArtrQ&usqp=CAU",
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQF8dnToWjhdzoNh7EoF9CbfkXhzNQaCFOhyg&usqp=CAU",
        ],
        template: "b",
        ttl: 4000,
        dates: {
          range: [new Date("2022-04-06"), new Date("2022-04-29")],
          days: [0, 2, 4, 5, 6],
          hours: [7, 19],
        },
      },
      {
        id: 3,
        title: "HEAD AND SHOULDERS",
        subtitle: "voted #1 on hair products",
        message: [
          "HEAD AND SHOULDERS FOR ALL HAIR TYPES",
          "WASH YOUR HAIR WITH THE BEST",
          "NOW ON STORES",
          "ON SALE FOR 24H",
        ],
        img: [
          "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT6eyqUv0Ey-dplxLl7dzh36MPZdLEBFGH0mg&usqp=CAU",
        ],
        template: "c",
        ttl: 5000,
        dates: {
          range: [new Date("2022-04-02"), new Date("2022-05-18")],
          days: [1, 2, 3, 4, 5],
          hours: [15, 23],
        },
      },
    ];

    let currentAd = 0;
    let changeOnTime;

    //returns t/f if ad in time to show
    const timeFrame = function (currDates) {
      const now = new Date();
      //dates check
      if (
        currDates.range[0] <= Date.now() &&
        currDates.range[1] >= Date.now()
      ) {
        //days of the week check
        if (currDates.days.includes(now.getDay())) {
          //houes check
          if (
            currDates.hours[0] <= now.getHours() &&
            currDates.hours[1] >= now.getHours()
          ) {
            return true;
          }
        }
      }
      return false;
    };

    //handle button click
    $("#btn_load_next").click(function () {
      clearTimeout(changeOnTime);
      nextAd();
      appendAd();
    });

    //switch the current ad to next ad
    const nextAd = function () {
      do {
        currentAd++;
        currentAd = currentAd % ads.length;
      } while (!timeFrame(ads[currentAd].dates));
    };

    //shows on screen
    const appendAd = function () {
      const template = "./" + ads[currentAd].template + ".html";

      $("#result").load(template, function () {
        $("#title").html(ads[currentAd].title);
        $("#subtitle").html(ads[currentAd].subtitle);

        if (ads[currentAd].template == "b") {
          $("#text").html(ads[currentAd].message[0] + "<p></p>");
          $("#title2").html(ads[currentAd].title);
          $("#subtitle2").html(ads[currentAd].subtitle);
          $("#text2").html(ads[currentAd].message[1] + "<p></p>");
          $("#title3").html(ads[currentAd].title);
          $("#subtitle3").html(ads[currentAd].subtitle);
          $("#text3").html(ads[currentAd].message[2] + "<p></p>");
        } else {
          $("#text").html(ads[currentAd].message.join("<p></p>"));
        }

        ads[currentAd].img.forEach(function (image, i) {
          const currImg = "#image-" + (i + 1);
          $(currImg).attr("src", image);
        });
      });

      changeOnTime = setTimeout(function () {
        //console.log("in time out");
        nextAd();
        appendAd();
      }, ads[currentAd].ttl);
    };

    //the first ad to show
    $(document).ready(appendAd);
  </script>
</html>
